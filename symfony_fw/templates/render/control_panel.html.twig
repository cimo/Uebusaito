{% extends "@templateRoot/layout/layout_site.html.twig" %}

{% import _self as macro %}

{% block headerContainer %}
    <header class="mdc-top-app-bar">
        <div class="mdc-top-app-bar__row">
            <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
                <a class="material-icons mdc-top-app-bar__navigation-icon menu_root_mobile display_mobile" href="javascript:void(0)">menu</a>
                <div class="display_desktop">
                    <img class="logo_main_big" src="{{asset("images/templates/" ~ settingRow['template'] ~ "/logo.svg")}}"/>
                    <span class="mdc-top-app-bar__title">{{websiteName}}</span>
                </div>
                <span class="mdc-top-app-bar__title display_mobile">
                    <img class="logo_main_small" src="{{asset("images/templates/" ~ settingRow['template'] ~ "/logo.svg")}}"/>
                </span>
            </section>
            <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-end" role="toolbar">
                {{-render(controller("App\\Controller\\SearchController::moduleAction", {'_locale': urlLocale, 'urlCurrentPageId': urlCurrentPageId, 'urlExtra': urlExtra}))-}}
                {{-render(controller("App\\Controller\\LanguageController::textAction", {'_locale': urlLocale, 'urlCurrentPageId': urlCurrentPageId, 'urlExtra': urlExtra}))-}}
                {{-include("@templateRoot/include/menu_user.html.twig")-}}
            </section>
        </div>
        <aside class="mdc-drawer mdc-drawer--temporary mdc-typography cp_menu">
            <nav class="mdc-drawer__drawer">
                <header class="mdc-drawer__header">
                    <div class="mdc-drawer__header-content">
                        <img class="logo_main_big" src="{{asset("images/templates/" ~ settingRow['template'] ~ "/logo.svg")}}"/>
                        <span>{{websiteName}}</span>
                    </div>
                </header>
                <nav class="mdc-drawer__content mdc-list">
                    {{macro.menuControlPanel(urlLocale)}}
                </nav>
            </nav>
        </aside>
    </header>
{% endblock %}

{% block columnLeftContainer %}
    {% if app.user %}
        <div class="sortable_column">
            <nav class="mdc-drawer mdc-drawer--permanent mdc-typography cp_menu">
                <div class="mdc-drawer__content">
                    <nav class="mdc-list">
                        {{macro.menuControlPanel(urlLocale)}}
                    </nav>
                </div>
            </nav>
        </div>
    {% endif %}
{% endblock %}

{% block columnCenterContainer %}
    {% if app.user %}
        <div class="sortable_column">
            {% if urlExtra == "" or urlExtra == "cp_sytem_info" %}
                {% if is_granted("ROLE_ADMIN") == true or is_granted("ROLE_MODERATOR") == true %}
                    <ul class="mdc-list mdc-list--two-line mdc-list--avatar-list cp_system_info">
                        {% for key, value in response.output.phpinfo %}
                            <li class="mdc-list-item">
                                <span class="mdc-list-item__graphic material-icons">info</span>
                                <span class="mdc-list-item__text">
                                    {{key}}
                                    <span class="mdc-list-item__secondary-text">
                                        {% for keySub, valueSub in value %}
                                            {% if valueSub is not iterable %}
                                                {{keySub}}: {{valueSub}}<br>
                                            {% endif %}
                                        {% endfor %}
                                    </span>
                                </span>
                            </li>
                            <li role="separator" class="mdc-list-divider"></li>
                        {% endfor %}
                    </ul>
                {% endif %}
            {% elseif urlExtra == "cp_payment" %}
                {% if is_granted("ROLE_ADMIN") == true or is_granted("ROLE_MODERATOR") == true %}
                    <p>{% trans %}controlPanel_payment_1{% endtrans %}</p>

                    {{-render(controller("App\\Controller\\ControlPanel\\PaymentController::selectionAction", {'_locale': urlLocale, 'urlCurrentPageId': urlCurrentPageId, 'urlExtra': urlExtra}))-}}
                    
                    <script type="text/javascript">
                        window.onload = function() {
                            controlPanelPayment.init();
                            controlPanelPayment.changeView();
                        };
                        
                        window.onresize = function() {
                            controlPanelPayment.changeView();
                        };
                        
                        var textPayment = {
                            'label_1': "{{"controlPanel_payment_2"|trans}}",
                            'label_2': "{{"controlPanel_payment_3"|trans}}"
                        };
                    </script>

                    <script type="text/javascript" src="{{asset("javascript/system/control_panel/Payment.js")}}"></script>
                {% endif %}
            {% elseif urlExtra == "cp_page" or urlExtra == "cp_page_create" or urlExtra == "cp_page_modify" %}
                {% if is_granted("ROLE_ADMIN") == true or is_granted("ROLE_MODERATOR") == true %}
                    <p>{% trans %}controlPanel_page_1{% endtrans %}</p>
                    <div class="cp_section_button">
                        <a class="mdc-button mdc-button--dense mdc-button--raised" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_page_create"})}}" type="button">{% trans %}controlPanel_10{% endtrans %}</a>
                        <a class="mdc-button mdc-button--dense mdc-button--raised" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_page_modify"})}}" type="button">{% trans %}controlPanel_11{% endtrans %}</a>
                    </div>

                    {% if urlExtra == "cp_page_create" %}
                        {{-render(controller("App\\Controller\\ControlPanel\\PageController::creationAction", {'_locale': urlLocale, 'urlCurrentPageId': urlCurrentPageId, 'urlExtra': urlExtra}))-}}
                    {% elseif urlExtra == "cp_page_modify" %}
                        {{-render(controller("App\\Controller\\ControlPanel\\PageController::selectionAction", {'_locale': urlLocale, 'urlCurrentPageId': urlCurrentPageId, 'urlExtra': urlExtra}))-}}
                    {% endif %}
                    
                    <script type="text/javascript">
                        window.onload = function() {
                            controlPanelPage.init();
                            controlPanelPage.changeView();
                        };
                        
                        window.onresize = function() {
                            controlPanelPage.changeView();
                        };

                        var textPage = {
                            'label_1': "{{"controlPanel_page_2"|trans}}",
                            'label_2': "{{"controlPanel_page_3"|trans}}"
                        };
                    </script>

                    <script type="text/javascript" src="{{asset("javascript/system/control_panel/Page.js")}}"></script>
                {% endif %}
            {% elseif urlExtra == "cp_user" or urlExtra == "cp_user_create" or urlExtra == "cp_user_modify" %}
                {% if is_granted("ROLE_ADMIN") == true or is_granted("ROLE_MODERATOR") == true %}
                    <p>{% trans %}controlPanel_user_1{% endtrans %}</p>
                    <div class="cp_section_button">
                        <a class="mdc-button mdc-button--dense mdc-button--raised" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_user_create"})}}" type="button">{% trans %}controlPanel_10{% endtrans %}</a>
                        <a class="mdc-button mdc-button--dense mdc-button--raised" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_user_modify"})}}" type="button">{% trans %}controlPanel_11{% endtrans %}</a>
                    </div>

                    {% if urlExtra == "cp_user_create" %}
                        {{-render(controller("App\\Controller\\ControlPanel\\UserController::creationAction", {'_locale': urlLocale, 'urlCurrentPageId': urlCurrentPageId, 'urlExtra': urlExtra}))-}}
                    {% elseif urlExtra == "cp_user_modify" %}
                        {{-render(controller("App\\Controller\\ControlPanel\\UserController::selectionAction", {'_locale': urlLocale, 'urlCurrentPageId': urlCurrentPageId, 'urlExtra': urlExtra}))-}}
                    {% endif %}
                    
                    <script type="text/javascript">
                        window.onload = function() {
                            controlPanelUser.init();
                            controlPanelUser.changeView();
                        };
                        
                        window.onresize = function() {
                            controlPanelUser.changeView();
                        };

                        var textUser = {
                            'label_1': "{{"controlPanel_user_2"|trans}}",
                            'label_2': "{{"controlPanel_user_3"|trans}}"
                        };
                    </script>

                    <script type="text/javascript" src="{{asset("javascript/system/control_panel/User.js")}}"></script>
                {% endif %}
            {% elseif urlExtra == "cp_module" or urlExtra == "cp_module_create" or urlExtra == "cp_module_modify" %}
                {% if is_granted("ROLE_ADMIN") == true or is_granted("ROLE_MODERATOR") == true %}
                    <p>{% trans %}controlPanel_module_1{% endtrans %}</p>
                    <div class="cp_section_button">
                        <a class="mdc-button mdc-button--dense mdc-button--raised" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_module_create"})}}" type="button">{% trans %}controlPanel_10{% endtrans %}</a>
                        <a class="mdc-button mdc-button--dense mdc-button--raised" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_module_modify"})}}" type="button">{% trans %}controlPanel_11{% endtrans %}</a>
                    </div>

                    {% if urlExtra == "cp_module_create" %}
                        {{-render(controller("App\\Controller\\ControlPanel\\ModuleController::creationAction", {'_locale': urlLocale, 'urlCurrentPageId': urlCurrentPageId, 'urlExtra': urlExtra}))-}}
                    {% elseif urlExtra == "cp_module_modify" %}
                        {{-render(controller("App\\Controller\\ControlPanel\\ModuleController::selectionAction", {'_locale': urlLocale, 'urlCurrentPageId': urlCurrentPageId, 'urlExtra': urlExtra}))-}}
                    {% endif %}
                    
                    <script type="text/javascript">
                        window.onload = function() {
                            controlPanelModule.init();
                            controlPanelModule.changeView();
                        };
                        
                        window.onresize = function() {
                            controlPanelModule.changeView();
                        };

                        var textModule = {
                            'label_1': "{{"controlPanel_module_2"|trans}}",
                            'label_2': "{{"controlPanel_module_3"|trans}}"
                        };
                    </script>

                    <script type="text/javascript" src="{{asset("javascript/system/control_panel/Module.js")}}"></script>
                {% endif %}
            {% elseif urlExtra == "cp_role" or urlExtra == "cp_role_create" or urlExtra == "cp_role_modify" %}
                {% if is_granted("ROLE_ADMIN") == true or is_granted("ROLE_MODERATOR") == true %}
                    <p>{% trans %}controlPanel_role_1{% endtrans %}</p>
                    <div class="cp_section_button">
                        <a class="mdc-button mdc-button--dense mdc-button--raised" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_role_create"})}}">{% trans %}controlPanel_10{% endtrans %}</a>
                        <a class="mdc-button mdc-button--dense mdc-button--raised" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_role_modify"})}}">{% trans %}controlPanel_11{% endtrans %}</a>
                    </div>

                    {% if urlExtra == "cp_role_create" %}
                        {{-render(controller("App\\Controller\\ControlPanel\\RoleUserController::creationAction", {'_locale': urlLocale, 'urlCurrentPageId': urlCurrentPageId, 'urlExtra': urlExtra}))-}}
                    {% elseif urlExtra == "cp_role_modify" %}
                        {{-render(controller("App\\Controller\\ControlPanel\\RoleUserController::selectionAction", {'_locale': urlLocale, 'urlCurrentPageId': urlCurrentPageId, 'urlExtra': urlExtra}))-}}
                    {% endif %}
                    
                    <script type="text/javascript">
                        window.onload = function() {
                            controlPanelRoleUser.init();
                            controlPanelRoleUser.changeView();
                        };
                        
                        window.onresize = function() {
                            controlPanelRoleUser.changeView();
                        };

                        var textRole = {
                            'label_1': "{{"controlPanel_role_2"|trans}}",
                            'label_2': "{{"controlPanel_role_3"|trans}}"
                        };
                    </script>

                    <script type="text/javascript" src="{{asset("javascript/system/control_panel/RoleUser.js")}}"></script>
                {% endif %}
            {% elseif urlExtra == "cp_setting" %}
                {% if is_granted("ROLE_ADMIN") == true %}
                    <p>{% trans %}controlPanel_setting_1{% endtrans %}</p>

                    {{-render(controller("App\\Controller\\ControlPanel\\SettingController::saveAction", {'_locale': urlLocale, 'urlCurrentPageId': urlCurrentPageId, 'urlExtra': urlExtra}))-}}
                    
                    <script type="text/javascript">
                        window.onload = function() {
                            controlPanelSetting.init();
                        };

                        var textSetting = {
                            'label_1': "{{"controlPanel_setting_2"|trans}}"
                        };
                    </script>

                    <script type="text/javascript" src="{{asset("javascript/system/control_panel/Setting.js")}}"></script>
                {% endif %}
            {% elseif (urlExtra == "cp_microservice_api" or urlExtra == "cp_microservice_api_create" or "cp_microservice_api_modify" in urlExtra) and settingRow['use_type'] == 2 %}
                {% if is_granted("ROLE_ADMIN") == true %}
                    <p>{% trans %}controlPanel_microservice_api_1{% endtrans %}</p>
                    
                    {% if urlExtra == "cp_microservice_api" %}
                        <div class="cp_section_button">
                            <a class="mdc-button mdc-button--dense mdc-button--raised" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_microservice_api_create"})}}">{% trans %}controlPanel_10{% endtrans %}</a>
                        </div>
                        
                        {{-render(controller("App\\Controller\\ControlPanel\\MicroserviceApiController::renderAction", {'_locale': urlLocale, 'urlCurrentPageId': urlCurrentPageId, 'urlExtra': urlExtra}))-}}
                    {% elseif urlExtra == "cp_microservice_api_create" %}
                        {{-render(controller("App\\Controller\\ControlPanel\\MicroserviceApiController::creationAction", {'_locale': urlLocale, 'urlCurrentPageId': urlCurrentPageId, 'urlExtra': urlExtra}))-}}
                    {% elseif "cp_microservice_api_modify" in urlExtra %}
                        {{-render(controller("App\\Controller\\ControlPanel\\MicroserviceApiController::profileSaveAction", {'_locale': urlLocale, 'urlCurrentPageId': urlCurrentPageId, 'urlExtra': urlExtra}))-}}
                    {% endif %}
                    
                    <script type="text/javascript">
                        window.onload = function() {
                            controlPanelMicroserviceApi.init();
                        };

                        var textMicroserviceApi = {
                            'label_1': "{{"controlPanel_microservice_api_2"|trans}}"
                        };
                    </script>

                    <script type="text/javascript" src="{{asset("javascript/system/control_panel/MicroserviceApi.js")}}"></script>
                {% endif %}
            {% endif %}
        </div>
    {% else %}
        <div class="sortable_column">
            <p>{% trans %}controlPanel_12{% endtrans %}</p>
        </div>
    {% endif %}
{% endblock %}

{% macro menuControlPanel(urlLocale) %}
    {% if is_granted("ROLE_ADMIN") == true or is_granted("ROLE_MODERATOR") == true %}
        <a class="mdc-list-item" href="{{path("root_render", {'_locale': urlLocale, 'urlCurrentPageId': 2, 'urlExtra': ""})}}">
            <i class="material-icons mdc-list-item__graphic">home</i>
            <span>{% trans %}controlPanel_1{% endtrans %}</span>
        </a>
        <a class="mdc-list-item" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_sytem_info"})}}">
            <i class="material-icons mdc-list-item__graphic">developer_board</i>
            <span>{% trans %}controlPanel_2{% endtrans %}</span>
        </a>
        <a class="mdc-list-item" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_payment"})}}">
            <i class="material-icons mdc-list-item__graphic">payment</i>
            <span>{% trans %}controlPanel_3{% endtrans %}</span>
        </a>
        <a class="mdc-list-item" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_page"})}}">
            <i class="material-icons mdc-list-item__graphic">pages</i>
            <span>{% trans %}controlPanel_4{% endtrans %}</span>
        </a>
        <a class="mdc-list-item" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_user"})}}">
            <i class="material-icons mdc-list-item__graphic">people</i>
            <span>{% trans %}controlPanel_5{% endtrans %}</span>
        </a>
        <a class="mdc-list-item" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_module"})}}">
            <i class="material-icons mdc-list-item__graphic">extension</i>
            <span>{% trans %}controlPanel_6{% endtrans %}</span>
        </a>
        <a class="mdc-list-item" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_role"})}}">
            <i class="material-icons mdc-list-item__graphic">label</i>
            <span>{% trans %}controlPanel_7{% endtrans %}</span>
        </a>
    {% endif %}

    {% if is_granted("ROLE_ADMIN") == true %}
        <a class="mdc-list-item" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_setting"})}}">
            <i class="material-icons mdc-list-item__graphic">settings</i>
            <span>{% trans %}controlPanel_8{% endtrans %}</span>
        </a>
        {% if settingRow['use_type'] == 2 %}
            <a class="mdc-list-item" href="{{path("control_panel", {'_locale': urlLocale, 'urlCurrentPageId': 0, 'urlExtra': "cp_microservice_api"})}}">
                <i class="material-icons mdc-list-item__graphic">perm_data_setting</i>
                <span>{% trans %}controlPanel_9{% endtrans %}</span>
            </a>
        {% endif %}
    {% endif %}
{% endmacro %}