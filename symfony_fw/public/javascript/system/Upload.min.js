var upload=new Upload;function Upload(){var t,a,s,i,o,r,l,e=this;function n(e){if(null!==o){var s=new FormData;s.append("file",e);var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState){var e=JSON.parse(n.response);if(void 0===e.response||200!==n.status)return;"upload"===e.response.upload.processFile.status&&(sizeStart<o.size?u():function(){if(null===o)return;var e=new FormData,s=new XMLHttpRequest;s.onreadystatechange=function(){if(o=null,r="",l=1048576,sizeStart=0,sizeEnd=l,$(a).find(".upload_chunk .file").val(""),$(a).find(".upload_chunk .mdc-linear-progress").hide(),4===s.readyState)if(""!==s.response){var e=JSON.parse(s.response);if(void 0===e.response||200!==s.status)return;"complete"===e.response.upload.processFile.status&&(""!==i&&utility.imageRefresh(i,1),void 0!==e.response.upload.processFile&&flashBag.show(e.response.upload.processFile.text))}else""!==i&&utility.imageRefresh(i,1),flashBag.show(window.textUpload.label_1)},s.open("post",t+"?action=complete&fileName="+r),s.send(e)}())}},n.open("post",t+"?action=upload&fileName="+r),n.send(s)}}function u(){null!==o&&(n(o.slice(sizeStart,sizeEnd)),materialDesign.linearProgress(s,sizeStart,o.size),sizeStart=sizeEnd,sizeEnd=sizeStart+l)}e.setUrlRequest=function(e){t=e},e.setTagContainer=function(e){a=e},e.setTagProgressBar=function(e){s=e},e.setTagImageRefresh=function(e){i=e},e.init=function(){o=null,r=s=i=a=t="",l=1048576,sizeStart=0,sizeEnd=l},e.processFile=function(){$(a).find(".upload_chunk .file").on("change","",function(){o=$(this)[0].files[0],r=o.name,function(){if(null===o)return;var e=new FormData,s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===s.readyState){var e=JSON.parse(s.response);if(void 0===e.response||200!==s.status)return;"start"===e.response.upload.processFile.status&&($(a).find(".upload_chunk .mdc-linear-progress").show(),u())}},s.open("post",t+"?action=start&fileName="+r),s.send(e)}()})}}