"use strict";const controlPanelPage=new ControlPanelPage;function ControlPanelPage(){let e,n,t;function o(n,o){if(ajax.reply(n,o),!1===$.isEmptyObject(n.response)&&void 0!==n.response.render){e=!0,$("#cp_page_select_result").html(n.response.render),l(),language.page(),wysiwyg.create("#form_page_argument",$("#form_cp_page_profile").find("input[type='submit']")),i(),s("#form_page_parent",n),helper.wordTag("#page_roleUserId","#form_page_roleUserId"),materialDesign.refresh(),$("#form_cp_page_profile").find(".form_row input, .form_row textarea").on("focus","",function(){t=!0});let o=!1;$("#form_cp_page_profile").find(".wysiwyg").on("mouseover","",function(){o=!0}),$("#form_cp_page_profile").find(".wysiwyg").on("mouseout","",function(){o=!1}),$(window).on("blur","",function(){!0===o&&(t=!0)}),$("#cp_page_saveDraft").on("click","",function(){a("modify")}),$("#cp_page_publishDraft").on("click","",function(){popupEasy.create(window.text.index_5,window.textPage.label_4,function(){$("#form_page_event").val("publish_draft"),$("#form_cp_page_profile").submit(),$("#form_page_event").val("")})}),$("#form_cp_page_profile").on("submit","",function(e){wysiwyg.save(),e.preventDefault(),ajax.send(!0,$(this).prop("action"),$(this).prop("method"),$(this).serialize(),"json",!1,!0,"application/x-www-form-urlencoded; charset=UTF-8",null,function(n){ajax.reply(n,"#"+e.currentTarget.id),!1===$.isEmptyObject(n.response.messages.success)&&(t=!1,$("#form_page_event").val(""),$("#cp_page_select_result").html(""),$("#cp_page_select_result_desktop").find(".refresh").click())},null,null)}),$("#cp_page_delete").on("click","",function(){r(null)})}}function l(){helper.sortableElement("#page_rankMenuSort","#form_page_rankMenuSort"),$("#form_page_parent").off("change").on("change","",function(){ajax.send(!0,window.url.cpPageProfileSort,"post",{event:"refresh",id:$(this).val(),token:window.session.token},"json",!1,!0,"application/x-www-form-urlencoded; charset=UTF-8",null,function(e){ajax.reply(e,""),void 0!==e.response.values.pageSortListHtml&&($("#page_rankMenuSort").find(".sort_result").html(e.response.values.pageSortListHtml),helper.sortableElement("#page_rankMenuSort","#form_page_rankMenuSort"))},null,null)})}function r(e){popupEasy.create(window.text.index_5,window.textPage.label_1,function(){ajax.send(!0,window.url.cpPageDelete,"post",{event:"delete",id:e,token:window.session.token},"json",!1,!0,"application/x-www-form-urlencoded; charset=UTF-8",null,function(n){ajax.reply(n,""),void 0!==n.response.values.text&&void 0!==n.response.values.button&&void 0!==n.response.values.pageSelectHtml?(popupEasy.create(window.text.index_5,n.response.values.text+n.response.values.button+n.response.values.pageSelectHtml),$("#cp_page_delete_parent_all").on("click","",function(){ajax.send(!0,window.url.cpPageDelete,"post",{event:"parentAll",id:e,token:window.session.token},"json",!1,!0,"application/x-www-form-urlencoded; charset=UTF-8",null,function(e){ajax.reply(e,""),p(e)},null,null)}),$("#cp_page_delete_parent_new").on("change","",function(){ajax.send(!0,window.url.cpPageDelete,"post",{event:"parentNew",id:e,parentNew:$(this).find("select").val(),token:window.session.token},"json",!1,!0,"application/x-www-form-urlencoded; charset=UTF-8",null,function(e){ajax.reply(e,""),p(e)},null,null)}),s("#cp_page_delete_parent_new",n)):p(n)},null,null)})}function a(e){popupEasy.create(window.text.index_5,window.textPage.label_3,function(){$("#form_page_event").val("save_draft_"+e),$("#form_cp_page_create").length>0?$("#form_cp_page_create").submit():$("#form_cp_page_profile").submit(),$("#form_page_event").val("")})}function s(e,n){let t=$(e).find("option"),o=!1,l=0;$.each(t,function(t,r){let a=parseInt(r.value),s=r.text.substr(0,r.text.indexOf("-|")+2),p=parseInt(n.response.values.pageId),i=parseInt(n.response.values.parentId);a===p||a===i?(o=!0,l=s.length):s.length<=l&&(o=!1),!0===o&&$(e).find("option").eq(t).prop("disabled",!0)})}function p(e){void 0!==e.response.messages.success&&($.each($("#cp_page_select_result_desktop").find("table .id_column"),function(n,t){(void 0!==e.response.values.id&&e.response.values.id===$.trim($(t).text())||void 0!==e.response.values.removedId&&-1!==$.inArray($.trim($(t).text()),e.response.values.removedId))&&$(t).parents("tr").remove()}),$("#form_page_select_id").find("option[value='"+e.response.values.id+"']").remove(),$("#cp_page_select_result").html(""),$("#cp_page_select_result_desktop").find(".refresh").click())}function i(){c(),_(),$("#form_page_showInMenu").on("change","",function(){c(),materialDesign.refresh()}),$("#form_page_onlyLink").on("change","",function(){_(),materialDesign.refresh()})}function c(){"0"===$("#form_page_showInMenu").val()?($("#form_page_menuName").parents(".form_row ").hide(),$("#page_rankMenuSort").hide()):($("#form_page_menuName").parents(".form_row ").show(),$("#page_rankMenuSort").show())}function _(){"0"===$("#form_page_onlyLink").val()?$("#form_page_link").parents(".form_row ").hide():$("#form_page_link").parents(".form_row ").show()}this.getProfileFocus=function(){return t},this.setProfileFocus=function(e){t=e},this.init=function(){e=!1,n=-1,t=!1},this.action=function(){!function(){const e=new TableAndPagination;e.init(),e.setButtonsStatus("show"),e.create(window.url.cpPageSelect,"#cp_page_select_result_desktop",!0),e.search(),e.pagination(),e.sort(),$(document).on("click","#cp_page_select_result_desktop .refresh",function(){ajax.send(!0,window.url.cpPageSelect,"post",{event:"refresh",token:window.session.token},"json",!1,!0,"application/x-www-form-urlencoded; charset=UTF-8",null,function(n){ajax.reply(n,""),e.populate(n)},null,null)}),$(document).on("click","#cp_page_select_result_desktop .delete_all",function(){popupEasy.create(window.text.index_5,window.textPage.label_2,function(){ajax.send(!0,window.url.cpPageDelete,"post",{event:"deleteAll",token:window.session.token},"json",!1,!0,"application/x-www-form-urlencoded; charset=UTF-8",null,function(e){ajax.reply(e,""),$.each($("#cp_page_select_result_desktop").find("table .id_column"),function(e,n){let t=$.trim($(n).parents("tr").find(".id_column").text());t>5&&$(n).parents("tr").remove()}),$("#cp_page_select_result").html("")},null,null)})}),$(document).on("click","#cp_page_select_result_desktop .cp_page_delete",function(){let e=$.trim($(this).parents("tr").find(".id_column").text());r(e)}),$(document).on("click","#cp_page_select_button_desktop",function(e){let n=$.trim($(this).parent().find(".checkbox_column input:checked").parents("tr").find(".id_column").text());ajax.send(!0,window.url.cpPageProfile,"post",{event:"result",id:n,token:window.session.token},"json",!1,!0,"application/x-www-form-urlencoded; charset=UTF-8",function(){$("#cp_page_select_result").html("")},function(n){o(n,"#"+e.currentTarget.id)},null,null)}),$(document).on("click",".checkbox_column input[type='checkbox']",function(){$("#cp_page_select_result").html("")})}(),$(document).on("submit","#form_cp_page_select_mobile",function(e){e.preventDefault(),ajax.send(!0,$(this).prop("action"),$(this).prop("method"),helper.serializeJson($(this)),"json",!1,!0,"application/x-www-form-urlencoded; charset=UTF-8",function(){$("#cp_page_select_result").html("")},function(n){o(n,"#"+e.currentTarget.id)},null,null)}),$(document).on("change","#form_page_select_id",function(){$("#cp_page_select_result").html("")}),l(),wysiwyg.create("#form_page_argument",$("#form_cp_page_create").find("input[type='submit']")),i(),helper.wordTag("#page_roleUserId","#form_page_roleUserId"),$("#cp_page_saveDraft").on("click","",function(){a("create")}),$("#form_cp_page_create").on("submit","",function(e){e.preventDefault(),ajax.send(!0,$(this).prop("action"),$(this).prop("method"),$(this).serialize(),"json",!1,!0,"application/x-www-form-urlencoded; charset=UTF-8",null,function(n){ajax.reply(n,"#"+e.currentTarget.id),void 0!==n.response.values&&void 0!==n.response.values.id&&($("#cp_page_select_result").html(""),$("#cp_page_select_result_desktop").find(".refresh").click())},null,null)})},this.changeView=function(){if(t=!1,"mobile"===helper.checkWidthType()){if(!0===e&&(n=$("#form_cp_page_select_mobile").find("select option:selected").val(),e=!1),n>=0){$("#cp_page_select_result_desktop").find(".checkbox_column input[type='checkbox']").prop("checked",!1);let e=$("#cp_page_select_result_desktop").find(".checkbox_column input[type='checkbox']").parents("tr").find(".id_column");$.each(e,function(e,t){$.trim($(t).text())===String(n)&&$(t).parents("tr").find(".checkbox_column input").prop("checked",!0)})}}else!0===e&&(n=$.trim($("#cp_page_select_result_desktop").find(".checkbox_column input[type='checkbox']:checked").parents("tr").find(".id_column").text()),e=!1),n>0&&$("#form_cp_page_select_mobile").find("select option[value='"+n+"']").prop("selected",!0);l()}}