"use strict";class WidgetDatePicker{set setLanguage(t){this.language=t}set setCurrentYear(t){this.currentYear=t}set setCurrentMonth(t){this.currentMonth=t-1}set setCurrentDay(t){this.currentDay=t}set setInputFill(t){!0===$(t).is("input")?this.inputFillTag=t:this.inputFillTag=$(t).find("input")}constructor(){this.language="",this.currentYear=-1,this.currentMonth=-1,this.currentDay=-1,this.yearMin=1900,this.yearMax=-1,this.monthDays=[31,28,31,30,31,30,31,31,30,31,30,31],this.monthLabels={en:["January","February","March","April","May","June","July","August","September","October","November","December"],jp:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],it:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"]},this.dayLabels={en:["S","M","T","W","T","F","S"],jp:["日","月","火","水","木","金","土"],it:["D","L","M","M","G","V","S"]},this.monthLength=0,this.weekCurrentDay=0,this.weekDayShift=0,this.dayFirstPosition=0,this.result="",this.inputFillTag="",this.currentInput=null}create=()=>{let t=new Date;-1===this.currentYear&&(this.currentYear=t.getFullYear()),-1===this.currentMonth&&(this.currentMonth=t.getMonth()),-1===this.currentDay&&(this.currentDay=t.getDate()),this.calculateMonthLength(),this.calculateWeekDayShift(),this.calculateDayPosition();let e=`<div class="widget_datePicker unselect">\n            ${this.createHeaderHtml(!0)}\n            ${this.createListYearsHtml()}\n            <div class="calendar">\n                ${this.createMonthHtml()}\n                ${this.createWeekHtml()}\n                ${this.createDayHtml()}\n                ${this.createButtonHtml()}\n            </div>\n        </div>`;0===$(".widget_datePicker").length?$("body").append(e):($(".loader_back").hide(),$(".widget_datePicker").remove(),$("body").append(e),$(".loader_back").show(),$(".widget_datePicker").show()),$.each($(".widget_datePicker").find(".mdc-select"),(t,e)=>{mdc.select.MDCSelect.attachTo(e)}),$.each($(".widget_datePicker").find(".mdc-button"),(t,e)=>{mdc.ripple.MDCRipple.attachTo(e)}),$.each($(".widget_datePicker").find(".mdc-fab"),(t,e)=>{mdc.ripple.MDCRipple.attachTo(e)}),this.action()};action=()=>{$(this.inputFillTag).off("click").on("click","",t=>{$(".loader_back").show(),$(".widget_datePicker").show(),this.currentInput=$(t.target)}),$(".widget_datePicker").find(".header p").off("click").on("click","",t=>{$(".widget_datePicker").find(".calendar").hide(),$(".widget_datePicker").find(".listYears").show();let e=$(".widget_datePicker").find(".listYears"),i=$(".widget_datePicker").find(".listYears .mdc-list-item--activated");e.animate({scrollTop:i.offset().top-e.offset().top+e.scrollTop()},"slow")}),$(".widget_datePicker").find(".listYears li").off("click").on("click","",t=>{this.currentYear=parseInt($.trim($(t.target).text())),this.create()}),$(".widget_datePicker").find(".calendar .month .material-icons").not(".mdc-fab").off("click").on("click","",t=>{"left"===$(t.target).parent().prop("class")?this.currentMonth-=1:this.currentMonth+=1,-1===this.currentMonth?(this.currentYear-=1,this.currentMonth=11):this.currentMonth===this.monthLabels[this.language].length&&(this.currentYear+=1,this.currentMonth=0),this.currentYear<this.yearMin?(this.currentYear=this.yearMin,this.currentMonth=0):this.currentYear>this.yearMax&&(this.currentYear=this.yearMax,this.currentMonth=11),this.create()}),$(".widget_datePicker").find(".day li span").off("mouseover").on("mouseover","",t=>{""!==$.trim($(t.target).text())&&$(t.target).addClass("mdc-theme--secondary-bg mdc-theme--on-secondary")}),$(".widget_datePicker").find(".day li span").off("mouseout").on("mouseout","",t=>{""!==$.trim($(t.target).text())&&$(t.target).removeClass("mdc-theme--secondary-bg mdc-theme--on-secondary")}),$(".widget_datePicker").find(".day li span").off("click").on("click","",t=>{let e=$.trim($(t.target).text());if(""!==e){$(t.target).parents(".day").find("li span").removeClass("mdc-theme--primary-bg mdc-theme--on-primary"),$(t.target).addClass("mdc-theme--primary-bg mdc-theme--on-primary"),this.currentDay=parseInt(e);let i=this.createHeaderHtml(!1);$(".widget_datePicker").find(".header .text").html(i)}}),$(".widget_datePicker").find(".button .button_today").off("click").on("click","",t=>{this.currentYear=-1,this.currentMonth=-1,this.currentDay=-1,this.create()}),$(".widget_datePicker").find(".button .button_clear").off("click").on("click","",t=>{this.fillInput(!1)}),$(".widget_datePicker").find(".button .button_confirm").off("click").on("click","",t=>{this.fillInput(!0)}),$(".widget_datePicker").find(".header > .mdc-fab").off("click").on("click","",t=>{$(this.currentInput).focus(),$(".loader_back").hide(),$(".widget_datePicker").hide()})};calculateMonthLength=()=>{this.monthLength=this.monthDays[this.currentMonth],1===this.currentMonth&&(this.currentYear%4==0&&this.currentYear%100!=0||this.currentYear%400==0)&&(this.monthLength=29)};calculateWeekDayShift=()=>{let t=0;"it"===this.language&&(t=1),this.weekDayShift=(t||0)%7,this.weekCurrentDay=this.dayLabels[this.language][(new Date(this.currentYear,this.currentMonth,this.currentDay).getDay()+this.weekDayShift+7)%7]};calculateDayPosition=()=>{this.dayFirstPosition=new Date(this.currentYear,this.currentMonth,1).getDay(),this.weekDayShift>this.dayFirstPosition&&(this.weekDayShift-=7)};createHeaderHtml=t=>{let e="";return!0===t?e=`<div class="mdc-theme--primary-bg mdc-theme--on-primary header">\n                <p>${this.currentYear}</p>\n                <div class="mdc-typography--headline6 text">${this.weekCurrentDay}, ${this.monthLabels[this.language][this.currentMonth]} ${this.currentDay}</div>\n                <button class="mdc-fab mdc-fab--mini cp_payment_delete" type="button" aria-label="label"><span class="mdc-fab__icon material-icons">close</span></button>\n            </div>`:!1===t&&(e=`${this.weekCurrentDay}, ${this.monthLabels[this.language][this.currentMonth]} ${this.currentDay}`),e};createListYearsHtml=()=>{this.yearMin=1900,this.yearMax=(new Date).getFullYear();let t='<div class="listYears">\n            <div class="mdc-list mdc-list--two-line mdc-list--avatar-list">\n                <ul>',e=0;for(let i=this.yearMin;i<=this.yearMax;i++){let a="mdc-list-item--activated";this.currentYear===i?t+=`<li class="mdc-list-item ${a}" role="option" value="${i}" tabindex="${e}">${i}</li>`:t+=`<li class="mdc-list-item" role="option" value="${i}" tabindex="${e}">${i}</li>`,e++}return t+="</ul>\n            </div>\n        </div>",t};createMonthHtml=()=>`<div class="month">\n            <div class="left"><i class="material-icons mdc-ripple-surface">keyboard_arrow_left</i></div>\n            <div class="mdc-typography--body2 label">${this.monthLabels[this.language][this.currentMonth]}</div>\n            <div class="right"><i class="material-icons mdc-ripple-surface">keyboard_arrow_right</i></div>\n        </div>`;createWeekHtml=()=>{let t='<div class="mdc-typography--body2 week"><ul>';for(let e=0;e<=6;e++)t+=`<li>${this.dayLabels[this.language][(e+this.weekDayShift+7)%7]}</li>`;return t+="</ul></div>",t};createDayHtml=()=>{let t='<div class="mdc-typography--body2 day">',e=1;for(let i=0;i<9;i++){t+="<ul>";for(let a=0;a<=6;a++)e===this.currentDay?i>0||a+this.weekDayShift>=this.dayFirstPosition?t+='<li><span class="mdc-theme--primary-bg mdc-theme--on-primary">':t+="</span><li>":t+="<li><span>",e<=this.monthLength&&(i>0||a+this.weekDayShift>=this.dayFirstPosition)?(t+=e,e++):t+="&nbsp;",t+="</span></li>";if(t+="</ul>",e>this.monthLength)break}return t+="</div>",t};createButtonHtml=()=>`<div class="button">\n            <button class="mdc-button mdc-button--dense mdc-button--raised button_today" type="button">${window.textWidgetDatePicker.label_1}</button>\n            <button class="mdc-button mdc-button--dense mdc-button--raised button_clear" type="button">${window.textWidgetDatePicker.label_2}</button>\n            <button class="mdc-button mdc-button--dense mdc-button--raised button_confirm" type="button">${window.textWidgetDatePicker.label_3}</button>\n        </div>`;fillInput=t=>{let e=this.currentMonth+1;this.result=this.currentYear+"-"+helper.padZero(e)+"-"+this.currentDay,"it"===this.language&&(this.result=this.currentDay+"-"+helper.padZero(e)+"-"+this.currentYear),!0===t?$(this.currentInput).val(this.result):$(this.currentInput).val(""),$(this.currentInput).parent().find(".mdc-text-field__label").length>0?!0===t?($(this.currentInput).parent().addClass("mdc-text-field--focused"),$(this.currentInput).parent().find(".mdc-text-field__label").addClass("mdc-text-field__label--float-above"),$(this.currentInput).parent().find(".mdc-line-ripple").addClass("mdc-line-ripple--active")):($(this.currentInput).parent().removeClass("mdc-text-field--focused"),$(this.currentInput).parent().find(".mdc-text-field__label").removeClass("mdc-text-field__label--float-above"),$(this.currentInput).parent().find(".mdc-line-ripple").removeClass("mdc-line-ripple--active")):$(this.currentInput).focus(),$(".loader_back").hide(),$(".widget_datePicker").hide()}}